<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Nuria y Sara | Avatar</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../styles/main.css">
    <style>
        body.avatar-page button {
            display: none;
        }
        body.avatar-page .avatar-question-button {
            display: inline-block;
        }
    </style>
</head>
<body class="avatar-page">

<main>

    <!-- 1. TÍTULO -->
    <h1 class="avatar-title">Nuria y Sara</h1>

    <!-- 2. AVATAR -->
    <div class="avatar-wrapper">
        <img src="../media/avatars/avatar_nuria_sara.png"
             alt="Nuria y Sara"
             class="avatar-img">
    </div>

    <!-- 3. RESPUESTA -->
    <div id="answerContainer" class="avatar-answer-area">
        <p class="placeholder">Selecciona una pregunta.</p>
    </div>

    <!-- 4. PREGUNTAS -->
    <h2>¿Qué quieres preguntar?</h2>
    <div id="questionsContainer"></div>

</main>

<!-- MOTOR DEL JUEGO -->
<script src="../js/engine.js"></script>

<script>
document.addEventListener("DOMContentLoaded", function () {

    /* CARGAR AVATAR */
    if (window.GameEngine && typeof GameEngine.renderAvatar === "function") {
        GameEngine.renderAvatar("nuria_sara", { nodeId: "relacion" });
    }

    const overlay = document.getElementById("avatarAnswerOverlay");
    const overlayText = document.getElementById("answerContainer");

    /* GESTIÓN DEL BOTÓN CERRAR DINÁMICO */
    document.addEventListener("click", function (ev) {
        const btn = ev.target;

        // Detecta botones “Cerrar” generados dentro de una respuesta
        if (
            btn.tagName === "BUTTON" &&
            btn.textContent.trim() === "Cerrar" &&
            btn.id !== "closeOverlayBtn"
        ) {
            ev.preventDefault();

            // 1. Ocultar overlay externo
            if (overlay) {
                overlay.style.display = "none";
            }

            // 2. Limpiar texto del overlay (no del recuadro blanco)
            if (overlayText) {
                overlayText.textContent = "";
            }
        }
    });
});
</script>

<div style="margin-top:2rem; text-align:center;">
    <a href="../mapa.html"
       class="btn avatar-overlay-close"
       style="text-decoration:none; padding:8px 18px; display:inline-block;">
        Secuencia investigación
    </a>
</div>

</body>
</html>
